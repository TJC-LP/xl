SHEET3.XML DEEP DIFF ANALYSIS
==============================
Input:  data/Syndigo Valuation_Q3 2025_2025.10.15_VALUES.xlsx
Output: data/syndigo-surgical-output.xlsx
Sheet:  "Syndigo - Valuation" (sheet3.xml)

FILE SIZE
---------
Input:  35 KB (1605 formatted lines)
Output: 32 KB (1584 formatted lines)
Delta:  -3 KB, -21 lines

ELEMENT COUNTS
--------------
Rows:   99 (input) ‚Üí 97 (output)  [MISSING 2 ROWS]
Cells:  881 (input) ‚Üí 882 (output) [+1 for Z100]

ROOT ELEMENT ISSUES
-------------------
‚ùå CRITICAL: Missing root attributes on <worksheet>:
   - mc:Ignorable="x14ac xr xr2 xr3"
   - xr:uid="{00000000-0001-0000-0100-000000000000}"

üî¥ SEVERE: Namespace pollution on ALL child elements
   Every element repeats 9 namespaces:
   - xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"
   - xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"
   - xmlns:xdr="http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing"
   - xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"
   - xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
   - xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"
   - xmlns:xr="http://schemas.microsoft.com/office/spreadsheetml/2014/revision"
   - xmlns:xr2="http://schemas.microsoft.com/office/spreadsheetml/2015/revision2"
   - xmlns:xr3="http://schemas.microsoft.com/office/spreadsheetml/2016/revision3"

   This adds ~400 bytes PER ELEMENT across ~50 elements = ~20KB overhead!

MISSING ROWS
------------
‚ùå Row 1: Empty row with formatting
   Input:  <row r="1" spans="2:16" s="7" customFormat="1" ht="12.95" customHeight="1" x14ac:dyDescent="0.25"/>
   Output: [MISSING]

‚ùå Row 2-104: Some rows have missing row-level attributes
   Example (Row 5):
   Input:  spans="2:16" s="333" customFormat="1" ht="12.75" customHeight="1" thickBot="1" x14ac:dyDescent="0.3"
   Output: [ALL ATTRIBUTES MISSING except r="5"]

ROW METADATA LOSS
-----------------
ALL rows lost these attributes:
  - spans (cell coverage)
  - s (row-level style)
  - customFormat
  - ht (height)
  - customHeight
  - thickBot (thick bottom border - critical for formatting!)
  - x14ac:dyDescent

CELL-LEVEL ISSUES
-----------------
‚ùå Cell attribute ordering changed:
   Input:  <c r="B2" s="248" t="s">  [CORRECT ORDER per OOXML spec]
   Output: <c t="s" s="221" r="B2"> [WRONG ORDER]

   OOXML spec requires: r, s, t, cm, vm, ph

‚ö†Ô∏è  Style IDs changed (expected if styles were reindexed):
   Cell B3: s="254" ‚Üí s="225"
   Cell B2: s="248" ‚Üí s="221"

MISSING WORKSHEET ELEMENTS
---------------------------
‚ùå <conditionalFormatting> - 12 instances lost
   Example: $O$3=1 conditional formatting on I76:J76

‚ùå <printOptions> - horizontalCentered="1"

‚ùå <rowBreaks> - Manual page break at row 93
   <brk id="93" min="1" max="11" man="1"/>

‚ùå <customProperties> - Worksheet GUID
   <customPr name="Guid" r:id="rId2"/>

PRESERVED ELEMENTS
------------------
‚úÖ <dimension> ref="B1:U104" - Correct
‚úÖ <sheetViews> - All view settings preserved
‚úÖ <sheetFormatPr> - Column/row defaults preserved
‚úÖ <cols> - All 8 column definitions preserved
‚úÖ <mergeCells> - All 10 merge ranges preserved
‚úÖ <pageMargins> - All margins preserved
‚úÖ <pageSetup> - Orientation, scale preserved (r:id="rId1")
‚úÖ <headerFooter> - Footer preserved
‚úÖ <drawing> - Drawing relationship preserved (r:id="rId3")
‚úÖ <legacyDrawing> - Legacy drawing preserved (r:id="rId4")
‚úÖ Z100 cell added successfully with SST index 148

SIZE BREAKDOWN
--------------
Namespace pollution: ~20 KB (9 namespaces √ó ~400 bytes √ó 50 elements)
Missing row attributes: ~2 KB (97 rows √ó ~20 bytes)
Missing elements: ~1 KB (conditionalFormatting, printOptions, rowBreaks, customProperties)
Total lost: ~23 KB

But output is only 3 KB smaller because namespace pollution ADDED 20 KB!

ROOT CAUSE
----------
1. XML serializer is not inheriting namespaces from root <worksheet> element
2. Each child element is re-declaring ALL namespaces (pollution)
3. Row metadata is not being preserved during surgical write
4. Cell attribute ordering is not following OOXML spec
5. Some worksheet sections are not being read/written (conditionalFormatting, etc.)

CORRUPTION SEVERITY
-------------------
üî¥ HIGH: Row 1 missing (data loss)
üî¥ HIGH: All row metadata lost (formatting corruption)
üî¥ HIGH: conditionalFormatting lost (formula-based formatting)
üî¥ HIGH: rowBreaks lost (page layout corruption)
üü° MEDIUM: Namespace pollution (bloat, non-compliant)
üü° MEDIUM: Cell attribute ordering (non-compliant, may break parsers)
üü° MEDIUM: Missing root attributes (compatibility issues)
üü¢ LOW: Style IDs changed (acceptable if semantically equivalent)

LIKELY EXCEL BEHAVIOR
----------------------
- May open with warnings about "repaired" content
- Row formatting will be lost (heights, borders)
- Conditional formatting rules will be lost
- Page breaks will be ignored
- File will be larger than necessary (namespace bloat)

RECOMMENDATIONS
---------------
1. Fix namespace serialization: Inherit from root, don't repeat
2. Preserve ALL row-level metadata during read/write
3. Implement conditionalFormatting read/write
4. Implement rowBreaks, printOptions, customProperties
5. Fix cell attribute ordering to match OOXML spec
6. Ensure empty rows (like row 1) are preserved
7. Add root worksheet attributes (mc:Ignorable, xr:uid)
